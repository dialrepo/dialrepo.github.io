<!DOCTYPE html>
<html>
    <head>
        <title>Hércules : Versiones</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Hércules</a></span>
                            </li>
                                                    <li>
                                <span><a href="597853529.html">Hércules</a></span>
                            </li>
                                                    <li>
                                <span><a href="597852519.html">SGI. Sistema de gestión de investigación</a></span>
                            </li>
                                                    <li>
                                <span><a href="597853531.html">Desarrollo y configuración</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Hércules : Versiones
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Reyes Hernández-Mora Martínez</span>, last modified on may 26, 2023
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><strong>Versión:</strong>0.1.0</p><p><strong>Fecha:</strong> </p><p><strong>Cambios:</strong> A continuación se adjunta excel que contiene una exportación de los jiras que se han resuelto e incorporado a la nueva versión</p><p><span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="/confluence/download/attachments/740524052/20230418Despliegue.xlsx?version=1&amp;modificationDate=1685086034000&amp;api=v2" data-nice-type="Excel Spreadsheet" data-file-src="/confluence/download/attachments/740524052/20230418Despliegue.xlsx?version=1&amp;modificationDate=1685086034000&amp;api=v2" data-linked-resource-id="740524054" data-linked-resource-type="attachment" data-linked-resource-container-id="740524052" data-linked-resource-default-alias="20230418Despliegue.xlsx" data-mime-type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" data-has-thumbnail="true" data-linked-resource-version="1" data-can-edit="true" aria-label="20230418Despliegue.xlsx" draggable="false"><img src="rest/documentConversion/latest/conversion/thumbnail/740524054/1" height="250" alt="" draggable="false"/></a><span class="companion-edit-button-placeholder edit-button-overlay" data-linked-resource-container-id="740524052" data-linked-resource-id="740524054" data-template-name="companionEditIcon" data-source-location="embedded-attachment"></span></span></p><p><strong>Instrucciones para la actualización:</strong></p><p>Para actualizar la versión actual instalada (0.0.13) a la última versión disponible, es necesario realizar los siguientes cambios en el fichero de configuración:</p><p style="margin-left: 40.0px;">Reemplazar las ocurrencias de “tag: 0.0.13” por “tag: 0.1.0”.<br/>Reemplazar el “tag: 0.1.0” por “tag: 0.2.0” para los siguientes servicios.<br/>sgi-webapp<br/>sgi-usr-service<br/>sgi-eti-service<br/>sgi-csp-service<br/>sgi-rep-service<br/>sgi-cnf-service<br/>sgi-keycloak<br/>sgi-esb<br/>Añadir en la configuración del ingress de sgi-esb dentro de annotations la siguiente configuración:<br/>·<span> </span><a class="external-link" href="http://nginx.ingress.kubernetes.io/proxy-read-timeout" rel="nofollow">nginx.ingress.kubernetes.io/proxy-read-timeout</a>: &quot;180&quot; #Default timeout 60s, needed for sge slow endpoints<span> </span><br/>Añadir en la configuración del ingress de sgi-cnf-service dentro de annotations la siguiente configuración:<br/>·<span> </span><a class="external-link" href="http://nginx.ingress.kubernetes.io/proxy-body-size" rel="nofollow">nginx.ingress.kubernetes.io/proxy-body-size</a>: &quot;10m&quot; #Default size is 1M<br/>Añadir dentro de extraEnvVariables de sgi-cnf-service la siguiente variable:<br/>· extraEnvVariables:<br/>· - name: SGI_RESOURCES-CACHE-MAX-AGE<br/>· value: &quot;60&quot;<br/>Una vez modificada la versión de despliegue, podemos proceder a la actualización de la aplicación ejecutando el siguiente comando (sustituir &lt;namespace&gt; con el nombre del namespace de Kubernetes correspondiente):</p><p style="margin-left: 40.0px;">helm repo update<br/>helm upgrade sgi treelogic_helm_nexus_repo/sgi-umbrella --timeout 10m0s --wait --wait-for-jobs --install --namespace &lt;namespace&gt; --version 0.1.46 -f ./values.sgi-dev-um.yaml</p><p style="margin-left: 40.0px;">Adicionalmente para esta versión es necesario realizar los siguientes cambios desde la página de administración del keycloak.</p><p style="margin-left: 40.0px;">En el menú Clients editar el client con id rep-service y seleccionar dentro de la pestaña Client Scopes el scope sgi-cnf en el selector Available Client Scopes de Optional Client Scopes y añadirlo pulsando en Add selected para que pase a Assigned Optional Client Scopes.<br/>En el menú Roles hacer click sobre el botón Add Role de la tabla de roles y crear un nuevo rol con el Role Name ADM-CNF-E.<br/>En el menú Groups hacer click sobre el botón New y crear un nuevo grupo con el nombre ADMINISTRADOR-SGI, después en la pestaña Role Mappings seleccionar el rol ADM-CNF-E creado antes entre los disponibles en Available Roles y hacer click en Add selected.<br/>Finalmente, en el menú Users añadir los usuarios administrador-sgi y super respectivamente.<br/>El proceso para crear los usuarios es el siguiente:</p><p style="margin-left: 40.0px;">Hacer click en Add userPoner en Username administrador-sgi y super<br/>Añadir en la pestaña Attributes los atributos:<br/>investigador: con value false en ambos casos<br/>userRefId: identificador de la entidad persona del SGP asociada a cada usuario<br/>Introducir la contraseña del usuario en la pestaña Credentials, y poner Temporary en off<br/>Dentro de la pestaña Groups seleccionar en Available Groups los grupos de permisos para cada usuario.<br/>administrador-sgi: ADMINISTRADOR-SGI<br/>super: ADMINISTRADOR-CSP, ADMINISTRADOR-ETICA, ADMINISTRADOR-PII, ADMINISTRADOR-SGI, GESTOR-CSP, GESTOR-EER, GESTOR-ETICA, GESTOR-PII, GESTOR-PRC, INVESTIGADOR</p><p><span>Las particularidades del despliegue en lo que se refiere al keycloak están detallados en los cambios de la versión del servicio asociado, en concreto aquí:</span></p><p><a class="external-link" href="https://urldefense.com/v3/__https://github.com/HerculesCRUE/SGI/blob/main/sgi-auth/changelog/v0_2_0.md__;!!D9dNQwwGXtA!TuhrYe-U_asWXJ6wbryJVBwqxe1s492Kg72jLJiFcW1JQlAaGKDLMuJ1Qc7LOcuQCqFHK7a1cR9Gg1yBVgGsMA$" rel="nofollow">https://github.com/HerculesCRUE/SGI/blob/main/sgi-auth/changelog/v0_2_0.md</a></p><p><span> </span></p>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/740524052/740524054.xlsx">20230418Despliegue.xlsx</a> (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on oct 09, 2024 11:38</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
