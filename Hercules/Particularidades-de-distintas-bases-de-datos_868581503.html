<!DOCTYPE html>
<html>
    <head>
        <title>Hércules : Particularidades de distintas bases de datos</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Hércules</a></span>
                            </li>
                                                    <li>
                                <span><a href="597853529.html">Hércules</a></span>
                            </li>
                                                    <li>
                                <span><a href="597852519.html">SGI. Sistema de gestión de investigación</a></span>
                            </li>
                                                    <li>
                                <span><a href="597853447.html">Guia de Implantación - Checklist</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Hércules : Particularidades de distintas bases de datos
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Reyes Hernández-Mora Martínez</span> on nov 28, 2023
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Aquí se encuentra la documentación de los cambios realizados en función de las distintas bases de datos que se han testado.1. La ordenación y las búsquedas no tienen que ser sensibles a los acentos ni distinguir entre mayúsculas y minúsculas.</p><h4 id="Particularidadesdedistintasbasesdedatos-Oracle:">Oracle:</h4><p>Hay que modificar las variables de sesion <strong>NLS_SORT </strong>para que use un collation como SPANISH_AI (tiene que tener sufijo AI que indica que no es sensible a acentos ni mayúsculas) y  <strong>NLS_COMP</strong> a LINGUISTIC para que las comparaciones se hagan de forma acorde a lo indicado en <strong>NLS_SORT. </strong></p><p>Para aplicar esta configuración usar un trigger que cambie en la sesion estos valores como el siguiente: </p><div class="table-wrap"><table class="confluenceTable"><tbody class=""><tr class=""><td class="confluenceTd"><p><strong>CREATE</strong> OR REPLACE <strong>TRIGGER</strong> SYS.ALTER_COLLATION_FOR_SGI</p><p><strong>AFTER</strong> LOGON <strong>on</strong> <strong>DATABASE</strong></p><p><strong>BEGIN</strong></p><p>    IF ( user like '%_SGI' ) <strong>THEN</strong></p><p>        <strong>execute</strong> immediate 'ALTER SESSION SET NLS_SORT=SPANISH_AI';</p><p>        <strong>execute</strong> immediate 'ALTER SESSION SET NLS_COMP=LINGUISTIC';</p><p>    <strong>END</strong> IF;</p><p><strong>END</strong>;</p></td></tr></tbody></table></div><p><br/></p><h4 id="Particularidadesdedistintasbasesdedatos-SQLServer:">SQL Server:</h4><p>Al crear la base de datos indicar un collation con los sufijos CI (case-insensitive) y AI (accent-insensitive) como Modern_Spanish_100_CI_AI.</p><div class="table-wrap"><table class="confluenceTable"><tbody class=""><tr class=""><td class="confluenceTd"><p><strong>CREATE</strong> <strong>DATABASE</strong> SGI <strong>COLLATE</strong> Modern_Spanish_100_CI_AI;</p></td></tr></tbody></table></div><p><br/></p><h3 id="Particularidadesdedistintasbasesdedatos-2.Lalongituddelascolumnasdetextosedebedemedirencaracteres,enlugardeenbytes.">2. La longitud de las columnas de texto se debe de medir en caracteres, en lugar de en bytes.</h3><h4 id="Particularidadesdedistintasbasesdedatos-Oracle:.1">Oracle:</h4><p>Para que se defina el tamaño en caracteres la propiedad <strong>NLS_LENGTH_SEMANTIC</strong> tiene que tener el valor CHAR, para hacerlo hay que usar un trigger que cambie en la sesion estos valores como el siguiente: </p><div class="table-wrap"><table class="confluenceTable"><tbody class=""><tr class=""><td class="confluenceTd"><p><strong>CREATE</strong> OR REPLACE <strong>TRIGGER</strong> SYS.ALTER_NLS_FOR_SGI</p><p><strong>AFTER</strong> LOGON <strong>on</strong> <strong>DATABASE</strong></p><p><strong>BEGIN</strong></p><p>    IF ( user like '%_SGI' ) <strong>THEN</strong></p><p>        <strong>execute</strong> immediate 'ALTER SESSION SET NLS_LENGTH_SEMANTICS=&quot;CHAR&quot;';</p><p>    <strong>END</strong> IF;</p><p><strong>END</strong>;</p></td></tr></tbody></table></div><p><br/></p><h4 id="Particularidadesdedistintasbasesdedatos-SQLServer:.1">SQL Server:</h4><p>Aunque la longitud se mide en bytes con las codificaciones habituales para el español los caracteres usan un solo byte.</p><h3 id="Particularidadesdedistintasbasesdedatos-3.(SQLServer)NiveldeaislamientoREAD_COMMITTED_SNAPSHOTsiseproducendeadlocks">3. (SQL Server) Nivel de aislamiento READ_COMMITTED_SNAPSHOT si se producen dead locks</h3><p>Tanto en Oracle como en SQL Server el nivel por defecto es READ_COMMITTED pero aunque el nombre sea el mismo no se comportan del mismo modo y SQL Server realiza bloqueos también en las lecturas  lo que puede producir dead locks con mayor probabilidad (<a class="external-link" href="https://urldefense.com/v3/__https:/www.dbi-services.com/blog/how-sql-server-mvcc-compares-to-oracle-and-postgresql/__;!!D9dNQwwGXtA!TToYltPgqmtNLz3xZmnEiCDVvltMFocbCqt412zS1ISYxl7RySU56QOb0lx_NhuR9aZgI7noW0SG3otNzLRD2Xez$" rel="nofollow">https://www.dbi-services.com/blog/how-sql-server-mvcc-compares-to-oracle-and-postgresql/</a>), en el caso de detectarlos se debería de configurar como READ_COMMITTED_SNAPSHOT que tiene un comportamiento más similar al comportamiento por defecto de postgres y oracle.</p><div class="table-wrap"><table class="confluenceTable"><tbody class=""><tr class=""><td class="confluenceTd"><p><strong>ALTER</strong> <strong>DATABASE</strong> SGI <strong>SET</strong> READ_COMMITTED_SNAPSHOT <strong>ON</strong>;</p></td></tr></tbody></table></div><p><br/></p>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on oct 09, 2024 11:56</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
